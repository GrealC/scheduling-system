# 项目开发文档

## 服务群体

1. 管理
2. 员工

---

# 管理端 

## 功能分析

### 1.功能

- 用户管理板块：
  - 注册新用户：新员工和管理员可以通过注册功能创建新账号(必须提供手机号)。
  - 找回密码：员工和管理员可以通过手机短信或者邮箱找回账号密码
  - 注销账户
  - 个人信息修改：员工和管理员可以修改个人信息
- 多店铺管理：一个管理可以开多个店铺(<=5)
  - 增加店铺
  - 查看店铺
  - 删除店铺
  - 店铺员工管理(增、删、查)
  - 店铺排班表查看
- 排班管理板块：
  - 创建排班表：一个店铺至多保存3张排班表
  - 排班规则设置：管理员可以设置排班的规则和参数
    - 设置每周工作天数、每天工作时段
    - 设置每天、每周、每月最长工作时长
  - 手动排班：管理员可以手动进行员工的排班安排。
  - 智能排班：系统根据历史数据和预测模型，自动生成智能排班建议，供管理员参考和调整。
    - 输入历史数据(客流量)
    - 选择可用员工
    - 自动生成排班表
    - 调整排班表
  - 排班查看：员工和管理员可以查看当前和未来的排班信息。
  - 排班调整：员工可以申请调度，在管理审批通过后，重新调整班次。
  - 导出排班表

- 预测与分析板块：
  - 业务预测
    - 数据收集：经理输入每日的客流量，用作之后的预测数据
    - 预测模型
  - 餐饮业务数据分析：可视化业务量与员工工作量
  - 薪资计算：根据员工的实际工作时间和排班情况，自动生成薪资计算报表，方便财务管理。
- 通知与提醒板块：(短信)
  - 通知功能：系统可以向员工发送排班通知、休假审批结果等通知，提醒他们的工作时间和任务。
  - 站内消息
- 员工管理(管理)
  - 员工信息管理
    - 导入员工信息：批量/单个
    - 导出员工信息(excel)
    - 修改员工信息
    - 删除员工信息
    - 查看员工信息(分组、分店铺):查看个人信息、工作时长等
  - 员工反馈信息管理：员工可以对排班进行反馈，提供意见和建议，供管理员参考改进排班策略。
  - 考勤管理：记录员工的实际上班情况和迟到早退情况、请假情况，可用于薪资计算等。
    - 请假管理：请假员工排班时不可选
    - 加班管理：需求加班时段员工排班时可选

### 2.结构图

![排班系统 (1)](D:\Download\Edge\排班系统 (1).png)

---

# 员工端

## 功能分析

### 1. 功能

- 用户管理板块：
  - 注册新用户：新员工和管理员可以通过注册功能创建新账号(必须提供手机号)。
  - 找回密码：员工和管理员可以通过手机短信或者邮箱找回账号密码
  - 注销账户
  - 个人信息修改：员工可以修改个人信息
  - 个人信息查看：工作时长、绩效、可工作时间(可视化)
    - 工作时长：员工可以查看自己的工作时长统计信息。
    - 绩效：员工可以查看自己的绩效评估信息。
    - 可工作时间（可视化）：以图表或日历形式展示员工的可工作时间，便于员工了解自己的排班情况。
- 排班管理：
  - 排班表查看：员工可以查看当前和未来的排班表，了解自己的排班安排。
  - 排班表修改申请：员工可以申请对排班表进行修改，如调整班次或更换排班，待管理员审批后生效。
- 请假管理：
  - 请假申请：员工可以申请请假，包括事假、病假、调休等类型。
  - 请假情况查看：员工可以查看自己的请假情况和假期余额。
- 加班管理：
  - 加班申请：员工可以申请加班，包括平时加班和节假日加班。
  - 加班情况查看：员工可以查看自己的加班情况和加班时长统计。
- 消息与反馈：
  - 站内消息：接收排班提醒和变更通知
  - 反馈功能：员工可以提交排班反馈、建议或意见，供管理员参考改进排班策略。
- 个人假期日历：
  - 假期日历：员工可以查看自己的假期日历，包括请假、加班、调休等信息。

### 2. 结构图

![排班(员工)](D:\Download\Edge\排班(员工).png)

---

# 数据库设计

## 用户数据表

1. `users`表：用户表

   - `user_id`: 主键，唯一标识每个用户。

   - `username`: 用户名，用于登录和显示。

   - `password`: 用户密码，加密存储。

   - `email`: 邮箱地址，用于找回密码功能。

   - `phone`: 手机号码，用于找回密码功能。

   - `speciality`：特长

   - `age`：年龄

   - `gender`：性别

   - `role`: 用户角色，区分管理员和员工(具体岗位：店长/服务员/后勤)。

   - `salary`: 目前所得工资

2. `employee_work_hours`表：工作时长表

   - `work_hours_id`: 主键，唯一标识每条员工工作时长记录。

   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示员工。

   - `date`: 工作日期。

   - `hours_worked`: 工作时长。

3. `employee_work_periods`表：工作时段表
   - `work_period_id`: 主键，唯一标识每条员工工作时段记录。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示员工。
   - `start_time`: 工作开始时间。(年、月、日、天的具体时段)
   - `end_time`: 工作结束时间。(年、月、日、天的具体时段)

4. `leave`表：
   - `leave_id`: 主键，唯一标识每次请假。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示请假员工。
   - `start_time`: 请假开始时间。
   - `end_time`: 请假结束时间。
   - `type`: 请假类型，事假、病假、调休等。
   - `status`: 请假状态，待审批、已审批等。
   - `reason`: 请假原因，员工填写的请假理由。
5. `overtime`表：
   - `overtime_id`: 主键，唯一标识每次加班。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示加班员工。
   - `start_time`: 加班开始时间。
   - `end_time`: 加班结束时间。
   - `type`: 加班类型，平时加班、节假日加班等。
   - `status`: 加班状态，待审批、已审批等。
   - `reason`: 加班原因，员工填写的加班理由。
6. `employee_vacation_calendars`表：
   - `calendar_id`: 主键，唯一标识每个员工休假日历。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示员工。
   - `date`: 休假日期。

## 排班相关表

1. `business_forecasts`表：
   - `forecast_id`: 主键，唯一标识每个业务预测。
   - `store_id`: 外键，关联到`stores`表的`store_id`字段，用于表示业务预测所属的店铺。
   - `date`: 预测日期。
   - `foot_traffic`: 客流量预测。

2. `business_history`表:
   - `history_id`:主键，唯一标识每个排班客流量信息。
   - `store_id`: 外键，关联到`stores`表的`store_id`字段，用于表示排班规则所属的店铺。
   - `date`: 日期
   - `weather`: 天气状况
   - `is_vacation`:(Boolean)是否是节假日
   - `business`: 客流量

3. `schedule_rules`表：
   - `rule_id`: 主键，唯一标识每个排班规则。
   - `store_id`: 外键，关联到`stores`表的`store_id`字段，用于表示排班规则所属的店铺。
   - `work_days_per_week`: 每周工作天数。
   - `work_hours_per_day`: 每天工作时长。
   - `days_work_period`: 每天工作时段
   - `max_work_hours_per_week`: 每周最长工作时长。
   - `max_work_hours_per_month`: 每月最长工作时长。

4. `schedule`表：
   - `schedule_id`: 主键，唯一标识每个排班。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示员工。
   - `store_id`: 店铺ID，用于标识排班所属的店铺。
   - `start_time`: 排班开始时间。
   - `end_time`: 排班结束时间。
   - `type`: 排班类型，手动排班、智能排班等。
   - `status`: 排班状态，待审批、已审批等。
   - `reason`: 修改排班原因，用于修改申请时填写理由。
5. `daily_schedule`表：
   - `schedule_id`: 主键，唯一标识每条具体排班记录。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示员工。
   - `store_id`: 店铺ID，用于标识排班所属的店铺。
   - `date`: 排班日期，表示具体哪一天的排班。
   - `start_time`: 排班开始时间。
   - `end_time`: 排班结束时间。
6. `store`表：
   - `store_id`: 主键，唯一标识每个店铺。
   - `store_name`: 店铺名称，用于显示和标识。
   - `manager_id`: 外键，关联到`users`表的`user_id`字段，用于表示店铺的管理员。
   - `max_schedules`: 最多保存的排班表数量，用于限制每个店铺保存的排班表数量。

## 消息反馈表

1. `feedback`表：
   - `feedback_id`: 主键，唯一标识每条反馈信息。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示提交反馈的员工。
   - `content`: 反馈内容，员工提交的反馈、建议或意见。
   - `status`: 反馈状态，待处理、已处理等。

2. `messages`表：
   - `message_id`: 主键，唯一标识每条站内消息。
   - `user_id`: 外键，关联到`users`表的`user_id`字段，用于表示消息接收者。
   - `content`: 消息内容。
   - `timestamp`: 消息发送时间。
